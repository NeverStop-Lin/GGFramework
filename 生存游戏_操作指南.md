# 生存游戏 - 完整操作指南

## 🎮 游戏简介

这是一个基于GGFramework开发的生存小游戏，包含以下核心玩法：
- 玩家移动控制（WASD）
- 生命值/饥饿/口渴系统
- 资源采集（木材、石头）
- 敌人AI系统
- 数据存档功能

## 📋 第一步：创建Excel配置表

### 1.1 打开Excel目录
- 在Unity菜单栏点击：`Tools/打开Excel目录`
- 会自动打开 `D:\GGFramework\Excel\` 文件夹

### 1.2 创建配置表
创建 `GameConfig.xlsx` 文件，包含两个Sheet：

#### Sheet 1: `#Resource#资源配置`
按以下格式填写：

| 注释       | 资源ID | 资源名称 | 生命值 | 采集时间(秒) | 奖励类型 | 奖励数量 |
|-----------|--------|---------|--------|-------------|---------|---------|
| 类型      | int    | string  | int    | float       | string  | int     |
| 字段名    | ID     | Name    | Health | CollectTime | RewardType | RewardAmount |
| 数据行1   | 1      | 树木    | 100    | 2.0         | Wood    | 5       |
| 数据行2   | 2      | 石头    | 150    | 3.0         | Stone   | 3       |

#### Sheet 2: `#Enemy#敌人配置`
按以下格式填写：

| 注释       | 敌人ID | 敌人名称 | 最大生命值 | 移动速度 | 攻击伤害 | 攻击间隔(秒) |
|-----------|--------|---------|----------|---------|---------|-------------|
| 类型      | int    | string  | int      | float   | int     | float       |
| 字段名    | ID     | Name    | MaxHealth| Speed   | Damage  | AttackInterval |
| 数据行1   | 1      | 僵尸    | 50       | 2.0     | 10      | 1.5         |
| 数据行2   | 2      | 骷髅    | 30       | 3.0     | 8       | 1.0         |

### 1.3 导出配置
- 保存Excel文件
- 在Unity菜单栏点击：`Tools/Excel导出`
- 等待导出完成

生成的文件位置：
- C#类：`Assets/Generate/Scripts/Configs/ResourceConfigs.cs` 和 `EnemyConfigs.cs`
- JSON数据：`Assets/Resources/Configs/Resource.json` 和 `Enemy.json`

---

## 🎨 第二步：创建UI预制体

### 2.1 MainMenuUI（主菜单）
**位置**：`Assets/Game/Resources/UI/MainMenuUI.prefab`

**结构**：
```
MainMenuUI (Canvas)
├── 标题文本 (Text)
├── 开始游戏按钮 (Button)
├── 继续游戏按钮 (Button)
└── 退出游戏按钮 (Button)
```

**关键设置**：
1. 在MainMenuUI预制体的Inspector中：
   - 找到 `Main Menu UI (Script)` 组件
   - 拖拽对应的按钮到字段：
     - `开始游戏按钮`
     - `继续游戏按钮`
     - `退出游戏按钮`

### 2.2 GameHUD（游戏主界面）
**位置**：`Assets/Game/Resources/UI/GameHUD.prefab`

**结构**：
```
GameHUD (Canvas)
├── 状态面板
│   ├── 生命值条 (Slider) - 命名为 "HealthBar"
│   ├── 生命值文本 (Text)
│   ├── 饥饿值条 (Slider) - 命名为 "HungerBar"
│   ├── 饥饿值文本 (Text)
│   ├── 口渴值条 (Slider) - 命名为 "ThirstBar"
│   └── 口渴值文本 (Text)
├── 资源面板
│   ├── 木材数量文本 (Text)
│   ├── 石头数量文本 (Text)
│   └── 生存时间文本 (Text)
└── 交互提示文本 (Text)
```

**关键设置**：
1. 在GameHUD预制体的Inspector中：
   - 找到 `Game HUD (Script)` 组件
   - 拖拽对应的UI组件到字段：
     - `生命值条`、`饥饿值条`、`口渴值条`
     - 各种文本组件

### 2.3 GameOverUI（游戏结束界面）
**位置**：`Assets/Game/Resources/UI/GameOverUI.prefab`

**结构**：
```
GameOverUI (Canvas)
├── 标题文本 (Text) - 显示"游戏结束"
├── 生存时间文本 (Text)
├── 收集统计文本 (Text)
├── 重新开始按钮 (Button)
└── 返回主菜单按钮 (Button)
```

**关键设置**：
1. 在GameOverUI预制体的Inspector中：
   - 拖拽文本和按钮到对应字段

---

## 🎮 第三步：创建游戏对象预制体

### 3.1 玩家预制体
**位置**：`Assets/Game/Resources/Player.prefab`

**创建步骤**：
1. 在场景中创建胶囊体：`GameObject > 3D Object > Capsule`
2. 重命名为 "Player"
3. 添加 `Character Controller` 组件
4. 添加 `PlayerController` 脚本组件
5. 设置Tag为 "Player"（重要！）
6. 在PlayerController组件中设置：
   - `移动速度`：5
   - `重力`：-9.81
   - `交互距离`：3
   - `交互层`：选择包含资源的层
7. 拖拽到Resources文件夹创建预制体

### 3.2 资源预制体
**位置**：`Assets/Game/Resources/Resource/`

#### 树木预制体（Tree.prefab）
1. 创建Cube（临时用方块代表树木）
2. 添加 `ResourceObject` 脚本
3. 在Inspector中设置：
   - `资源ID`：1（对应Excel中的树木ID）
4. 创建预制体

#### 石头预制体（Stone.prefab）
1. 创建Sphere（临时用球体代表石头）
2. 添加 `ResourceObject` 脚本
3. 在Inspector中设置：
   - `资源ID`：2（对应Excel中的石头ID）
4. 创建预制体

### 3.3 敌人预制体
**位置**：`Assets/Game/Resources/Enemy/`

#### 僵尸预制体（Zombie.prefab）
1. 创建Capsule（红色胶囊代表僵尸）
2. 添加 `EnemyController` 脚本
3. 在Inspector中设置：
   - `敌人ID`：1（对应Excel中的僵尸ID）
   - `检测范围`：10
   - `攻击范围`：2
   - `巡逻范围`：5
   - `显示调试信息`：勾选
4. 创建预制体

### 3.4 GameManager预制体
**位置**：`Assets/Game/Resources/GameManager.prefab`

1. 创建空对象：`GameObject > Create Empty`
2. 重命名为 "GameManager"
3. 添加 `GameManager` 脚本
4. 在Inspector中设置：
   - `玩家控制器`：拖拽场景中的Player对象
   - `资源生成器`：拖拽场景中的ResourceSpawner对象
   - `敌人生成器`：拖拽场景中的EnemySpawner对象
   - `开启调试日志`：勾选
5. 创建预制体

---

## 🗺️ 第四步：搭建游戏场景

### 4.1 基础场景搭建
1. 打开 `Assets/Game/Scene.unity`
2. 创建地面：
   - `GameObject > 3D Object > Plane`
   - 缩放到合适大小（如Scale: 10, 1, 10）
   - 设置Layer为地面层

### 4.2 添加玩家
1. 将 `Player.prefab` 拖入场景
2. 设置位置：Position (0, 1, 0)
3. 添加主相机跟随（可选）

### 4.3 添加资源生成器
1. 创建空对象：`GameObject > Create Empty`
2. 重命名为 "ResourceSpawner"
3. 添加 `ResourceSpawner` 脚本
4. 在Inspector中设置：
   - `资源预制体列表`：
     - Size: 2
     - Element 0: 拖拽 Tree.prefab
     - Element 1: 拖拽 Stone.prefab
   - `初始生成数量`：20
   - `生成半径`：50
   - `地面层`：选择地面层
   - `生成中心`：(0, 0, 0)

### 4.4 添加敌人生成器
1. 创建空对象：`GameObject > Create Empty`
2. 重命名为 "EnemySpawner"
3. 添加 `EnemySpawner` 脚本
4. 在Inspector中设置：
   - `敌人预制体列表`：
     - Size: 1
     - Element 0: 拖拽 Zombie.prefab
   - `生成间隔`：15
   - `最大敌人数量`：10
   - `生成半径`：30
   - `最小距离玩家`：15
   - `玩家变换`：拖拽场景中的Player对象

### 4.5 配置Launcher
1. 找到场景中的 `Launcher` 对象
2. 在Inspector中：
   - 找到 `Launcher (Script)` 组件
   - `游戏管理器预制体`：拖拽 GameManager.prefab

---

## ▶️ 第五步：运行游戏

### 5.1 测试流程
1. 保存场景
2. 点击Unity的Play按钮
3. 应该看到主菜单界面

### 5.2 游戏操作
- **WASD**：移动玩家
- **E**：采集资源（靠近资源时按住）
- **鼠标**：调整视角（如果有相机跟随）

### 5.3 检查功能
- [ ] 主菜单显示正常
- [ ] 点击"开始游戏"进入游戏
- [ ] 玩家可以移动
- [ ] 场景中生成了资源
- [ ] HUD显示生命值、饥饿值、口渴值
- [ ] 饥饿和口渴值会持续下降
- [ ] 可以采集资源
- [ ] 敌人会定时生成并追击玩家
- [ ] 生命值为0时显示游戏结束界面

---

## 🎯 框架模块使用说明

### 已使用的框架模块

1. **UI系统** (`IUI`)
   - 所有UI继承自 `UIBehaviour`
   - 使用 `GridFramework.UI.Show<T>()` 显示UI
   - 使用 `GridFramework.UI.Hide<T>()` 隐藏UI

2. **Observer系统** (`IObservers`)
   - `PlayerData` 使用 `Cache` 类型观察者
   - UI通过监听观察者自动更新显示
   - 支持数据持久化到本地

3. **Config系统** (`IConfigs`)
   - 从Excel生成配置类
   - `GameManager` 加载并缓存配置

4. **Timer系统** (`TimerCenter`)
   - `PlayerStatsSystem` 使用定时器处理饥饿/口渴消耗
   - `EnemySpawner` 使用定时器生成敌人

5. **Storage系统** (`IStorage`)
   - 通过 `Observer.Cache` 自动存储数据
   - 支持存档的保存、加载、清除

---

## 🐛 常见问题

### Q1: 导出Excel时报错
**A**: 确保Excel格式正确：
- Sheet名必须以 `#` 开头
- 前三行是注释、类型、字段名
- 第一列必须是int类型的ID

### Q2: 配置加载失败
**A**: 检查：
1. 是否执行了 `Tools/Excel导出`
2. `Assets/Resources/Configs/` 下是否有JSON文件
3. `Assets/Generate/Scripts/Configs/` 下是否有C#文件

### Q3: UI不显示
**A**: 检查：
1. UI预制体是否在 `Assets/Game/Resources/UI/` 目录下
2. UI预制体的名称是否与类名一致（如GameHUD.prefab对应GameHUD类）
3. Canvas是否有EventSystem

### Q4: 玩家无法采集资源
**A**: 检查：
1. 资源对象是否在正确的Layer
2. PlayerController的 `交互层` 是否设置正确
3. 资源对象是否有Collider组件

---

## 📝 后续扩展建议

1. **添加背包系统**：可以消耗资源制作物品
2. **添加建造系统**：使用资源建造防御工事
3. **添加昼夜系统**：夜晚敌人更强
4. **添加音效**：使用框架的 `SoundModule`
5. **添加粒子效果**：采集、攻击时的特效
6. **优化AI**：使用NavMesh实现更好的寻路

---

## 🎊 完成！

现在你应该有一个完整的生存小游戏框架了！所有核心代码都已经写好，你只需要按照上面的步骤创建预制体和配置场景即可。

祝你游戏开发愉快！🎮

