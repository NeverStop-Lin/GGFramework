# UIç³»ç»Ÿä½¿ç”¨æŒ‡å—

> **ç‰ˆæœ¬**: v2.0  
> **æ›´æ–°æ—¥æœŸ**: 2025-01-26  
> **é€‚ç”¨èŒƒå›´**: GGFramework UIç³»ç»Ÿ

---

## ğŸ“‹ ç›®å½•

1. [å¿«é€Ÿå¼€å§‹](#1-å¿«é€Ÿå¼€å§‹)
2. [æ ‡è®°è§„èŒƒ](#2-æ ‡è®°è§„èŒƒ)
3. [ä»£ç ç”Ÿæˆ](#3-ä»£ç ç”Ÿæˆ)
4. [UIé…ç½®](#4-uié…ç½®)
5. [æ•°æ®ç»‘å®š](#5-æ•°æ®ç»‘å®š)
6. [é«˜çº§åŠŸèƒ½](#6-é«˜çº§åŠŸèƒ½)
7. [å¸¸è§é—®é¢˜](#7-å¸¸è§é—®é¢˜)

---

## 1. å¿«é€Ÿå¼€å§‹

### 1.1 åˆ›å»ºç¬¬ä¸€ä¸ªUIï¼ˆ5åˆ†é’Ÿæ•™ç¨‹ï¼‰

#### æ­¥éª¤1ï¼šåœ¨Unityä¸­è®¾è®¡UI Prefab

1. åœ¨Unityä¸­åˆ›å»ºä¸€ä¸ªæ–°çš„Canvasï¼ˆGameObject -> UI -> Canvasï¼‰
2. è®¾è®¡ä½ çš„UIç•Œé¢ï¼Œæ·»åŠ Buttonã€Textã€Imageç­‰ç»„ä»¶
3. **å…³é”®æ­¥éª¤**ï¼šç»™éœ€è¦ç»‘å®šçš„ç»„ä»¶æ·»åŠ `@`å‰ç¼€æ ‡è®°
   ```
   Canvas
     â””â”€ Panel
         â”œâ”€ @Button_Start      â† å¼€å§‹æŒ‰é’®
         â”œâ”€ @Button_Settings   â† è®¾ç½®æŒ‰é’®
         â””â”€ @Text_Title        â† æ ‡é¢˜æ–‡æœ¬
   ```
4. ä¿å­˜ä¸ºPrefabï¼šæ‹–æ‹½åˆ° `Assets/Resources/UI/` ç›®å½•ï¼Œå‘½åä¸º `MainMenu.prefab`

#### æ­¥éª¤2ï¼šç”ŸæˆUIä»£ç 

1. æ‰“å¼€ç”Ÿæˆå™¨ï¼šèœå• `Tools -> UIå·¥å…· -> ç”ŸæˆUIä»£ç `
2. ç‚¹å‡»"æ·»åŠ Prefab"ï¼Œé€‰æ‹© `MainMenu.prefab`
3. é…ç½®å‘½åç©ºé—´ï¼ˆå¦‚ï¼š`Game.UI`ï¼‰
4. é…ç½®è¾“å‡ºè·¯å¾„ï¼ˆå¦‚ï¼š`Assets/Game/Scripts/UI`ï¼‰
5. ç‚¹å‡»"ç”Ÿæˆä»£ç "

#### æ­¥éª¤3ï¼šç¼–å†™ä¸šåŠ¡é€»è¾‘

ç”Ÿæˆå™¨ä¼šåˆ›å»ºä¸¤ä¸ªæ–‡ä»¶ï¼š
- `MainMenuUI.Binding.cs` - è‡ªåŠ¨ç”Ÿæˆï¼Œä¸è¦ä¿®æ”¹
- `MainMenuUI.cs` - ä¸šåŠ¡é€»è¾‘ï¼Œåœ¨è¿™é‡Œç¼–å†™ä»£ç 

æ‰“å¼€ `MainMenuUI.cs`ï¼š

```csharp
namespace Game.UI
{
    public partial class MainMenuUI
    {
        // æ˜¾ç¤ºæ—¶çš„é€»è¾‘
        protected override void OnShow(params object[] args)
        {
            base.OnShow(args);
            
            _titleText.text = "ä¸»èœå•";  // è‡ªåŠ¨ç»‘å®šçš„å­—æ®µï¼Œç›´æ¥ä½¿ç”¨
        }
        
        // æŒ‰é’®ç‚¹å‡»äº‹ä»¶ï¼ˆè‡ªåŠ¨ç”Ÿæˆçš„æ–¹æ³•ç­¾åï¼‰
        private void OnStartClick()
        {
            Hide();
            GridFramework.UI.Show<GameUI>();
        }
        
        private void OnSettingsClick()
        {
            GridFramework.UI.Show<SettingsUI>();
        }
    }
}
```

#### æ­¥éª¤4ï¼šæ˜¾ç¤ºUI

åœ¨ä½ çš„æ¸¸æˆä»£ç ä¸­ï¼š

```csharp
using Game.UI;

public class GameLauncher : MonoBehaviour
{
    void Start()
    {
        // æ˜¾ç¤ºä¸»èœå•
        GridFramework.UI.Show<MainMenuUI>();
    }
}
```

âœ… å®Œæˆï¼ä½ çš„ç¬¬ä¸€ä¸ªUIå·²ç»è¿è¡Œäº†ï¼

---

## 2. æ ‡è®°è§„èŒƒ

### 2.1 æ”¯æŒçš„ç»„ä»¶æ ‡è®°

| æ ‡è®°æ ¼å¼ | ç»„ä»¶ç±»å‹ | ç”Ÿæˆå­—æ®µ | ç¤ºä¾‹ |
|---------|---------|---------|------|
| `@Button_åç§°` | Button | `_åç§°Button` | `@Button_Start` â†’ `_startButton` |
| `@Text_åç§°` | Text | `_åç§°Text` | `@Text_Title` â†’ `_titleText` |
| `@TextTMP_åç§°` | TextMeshProUGUI | `_åç§°Text` | `@TextTMP_Title` â†’ `_titleText` |
| `@Image_åç§°` | Image | `_åç§°Image` | `@Image_Icon` â†’ `_iconImage` |
| `@Input_åç§°` | InputField | `_åç§°Input` | `@Input_Name` â†’ `_nameInput` |
| `@Toggle_åç§°` | Toggle | `_åç§°Toggle` | `@Toggle_Sound` â†’ `_soundToggle` |
| `@Slider_åç§°` | Slider | `_åç§°Slider` | `@Slider_Volume` â†’ `_volumeSlider` |
| `@Transform_åç§°` | Transform | `_åç§°Transform` | `@Transform_Container` â†’ `_containerTransform` |
| `@GameObject_åç§°` | GameObject | `_åç§°GameObject` | `@GameObject_Panel` â†’ `_panelGameObject` |

### 2.2 å‘½åè§„åˆ™

**æ­£ç¡®ç¤ºä¾‹**ï¼š
```
@Button_Start         âœ… ç®€å•åç§°
@Button_Close_Panel   âœ… å¤šå•è¯ç”¨ä¸‹åˆ’çº¿åˆ†éš”
@Text_Player_Name     âœ… å¤šå•è¯
```

**é”™è¯¯ç¤ºä¾‹**ï¼š
```
Button_Start          âŒ ç¼ºå°‘@å‰ç¼€ï¼ˆä¸ä¼šè¢«è¯†åˆ«ï¼‰
@button_start         âŒ ä¸ç¬¦åˆé©¼å³°è§„èŒƒ
@ButtonStart          âŒ ç¼ºå°‘ä¸‹åˆ’çº¿åˆ†éš”
```

### 2.3 Buttonè‡ªåŠ¨äº‹ä»¶ç»‘å®š

Buttonç»„ä»¶ä¼šè‡ªåŠ¨ç”Ÿæˆäº‹ä»¶ç»‘å®šï¼š

```csharp
@Button_Start      â†’ OnStartClick()
@Button_Close      â†’ OnCloseClick()
@Button_Buy_Item   â†’ OnBuyItemClick()
```

ä½ åªéœ€è¦åœ¨Logicæ–‡ä»¶ä¸­å®ç°è¿™äº›æ–¹æ³•ã€‚

---

## 3. ä»£ç ç”Ÿæˆ

### 3.1 ç”Ÿæˆå™¨çª—å£

**æ‰“å¼€æ–¹å¼**ï¼š
- èœå•ï¼š`Tools -> UIå·¥å…· -> ç”ŸæˆUIä»£ç `
- å³é”®Prefabï¼š`ç”ŸæˆUIä»£ç `

**åŠŸèƒ½**ï¼š
- å•ä¸ªPrefabç”Ÿæˆ
- æ‰¹é‡ç”Ÿæˆï¼ˆå¤šé€‰Prefabï¼‰
- ç›®å½•æ‰«ææ‰¹é‡ç”Ÿæˆ

### 3.2 ç”Ÿæˆçš„æ–‡ä»¶

#### Binding.csï¼ˆè‡ªåŠ¨ç”Ÿæˆï¼Œæ¯æ¬¡è¦†ç›–ï¼‰

```csharp
// <auto-generated />
// è­¦å‘Š: è¯·å‹¿æ‰‹åŠ¨ä¿®æ”¹æ­¤æ–‡ä»¶

public partial class MainMenuUI : UGUIBaseUI
{
    #region Auto-Generated Fields
    private Button _startButton;
    private Text _titleText;
    #endregion
    
    #region Auto-Generated Binding
    protected override void BindComponents()
    {
        base.BindComponents();
        _startButton = FindComponent<Button>("Panel/@Button_Start");
        _titleText = FindComponent<Text>("Panel/@Text_Title");
    }
    #endregion
    
    #region Auto-Generated Events
    protected override void RegisterEvents()
    {
        base.RegisterEvents();
        _startButton.onClick.AddListener(OnStartClick);
    }
    
    protected override void UnregisterEvents()
    {
        _startButton.onClick.RemoveListener(OnStartClick);
        base.UnregisterEvents();
    }
    #endregion
}
```

#### Logic.csï¼ˆä»…é¦–æ¬¡ç”Ÿæˆï¼Œå¯æ‰‹åŠ¨ä¿®æ”¹ï¼‰

```csharp
namespace Game.UI
{
    public partial class MainMenuUI
    {
        #region UIé…ç½®
        protected override UIConfig CreateUIConfig()
        {
            return new UIConfig
            {
                ResourcePath = "UI/MainMenu",
                UIType = UIType.Main,
                CacheStrategy = UICacheStrategy.AlwaysCache
            };
        }
        #endregion
        
        #region ç”Ÿå‘½å‘¨æœŸ
        protected override void OnShow(params object[] args)
        {
            base.OnShow(args);
            // TODO: å®ç°æ˜¾ç¤ºé€»è¾‘
        }
        #endregion
        
        #region äº‹ä»¶å¤„ç†
        private void OnStartClick()
        {
            // TODO: å®ç°ç‚¹å‡»é€»è¾‘
        }
        #endregion
    }
}
```

### 3.3 å¢é‡æ›´æ–°

å½“Prefabæ”¹åŠ¨åï¼š
1. é‡æ–°é€‰æ‹©Prefab
2. ç‚¹å‡»"ç”Ÿæˆä»£ç "
3. **åªæ›´æ–°Binding.cs**ï¼ŒLogic.csä¸ä¼šè¢«è¦†ç›–

---

## 4. UIé…ç½®

### 4.1 ä»£ç é…ç½®

åœ¨ `CreateUIConfig()` ä¸­é…ç½®ï¼š

```csharp
protected override UIConfig CreateUIConfig()
{
    return new UIConfig
    {
        ResourcePath = "UI/MainMenu",        // èµ„æºè·¯å¾„
        UIType = UIType.Main,                 // UIç±»å‹
        AlignType = UIAlignType.Center,       // å¯¹é½æ–¹å¼
        CacheStrategy = UICacheStrategy.AlwaysCache,  // ç¼“å­˜ç­–ç•¥
        UseMask = false,                      // æ˜¯å¦ä½¿ç”¨é®ç½©
        UseAnimation = true,                  // æ˜¯å¦ä½¿ç”¨åŠ¨ç”»
        AnimationType = UIAnimationType.Fade, // åŠ¨ç”»ç±»å‹
        Preload = false                       // æ˜¯å¦é¢„åŠ è½½
    };
}
```

### 4.2 è¿è¡Œæ—¶é…ç½®ï¼ˆUIManifestï¼‰

åœ¨ `Assets/Resources/Config/UIManifest.asset` ä¸­é…ç½®ï¼š

1. åœ¨Projectçª—å£æ‰¾åˆ°UIManifest
2. åœ¨Inspectorä¸­ç¼–è¾‘
3. æ·»åŠ æˆ–ä¿®æ”¹UIé…ç½®

**è¿è¡Œæ—¶é…ç½®ä¼˜å…ˆçº§é«˜äºä»£ç é…ç½®ï¼**

### 4.3 é…ç½®é¡¹è¯´æ˜

| é…ç½®é¡¹ | ç±»å‹ | è¯´æ˜ |
|--------|------|------|
| ResourcePath | string | UIèµ„æºè·¯å¾„ï¼ˆç›¸å¯¹äºResourcesï¼‰ |
| UIType | enum | Main/Popup/Top/Effect |
| AlignType | enum | Center/Top/Bottom |
| CacheStrategy | enum | AlwaysCache/NeverCache/LRU |
| UseMask | bool | æ˜¯å¦æ·»åŠ åŠé€æ˜é®ç½© |
| UseAnimation | bool | æ˜¯å¦ä½¿ç”¨æ˜¾ç¤º/éšè—åŠ¨ç”» |
| AnimationType | enum | Fade/Scale/Slide/Custom |
| Preload | bool | æ˜¯å¦åœ¨å¯åŠ¨æ—¶é¢„åŠ è½½ |

---

## 5. æ•°æ®ç»‘å®š

### 5.1 ä¸Observeré›†æˆ

```csharp
using Framework.Core;

public partial class MainMenuUI
{
    private IValueObserver<int> _goldObserver;
    
    protected override void OnShow(params object[] args)
    {
        base.OnShow(args);
        
        // åˆ›å»ºæˆ–è·å–Observer
        _goldObserver = GridFramework.Observer.Cache("player_gold", 100);
        
        // ç»‘å®šåˆ°Textï¼ˆæ•°æ®å˜åŒ–è‡ªåŠ¨æ›´æ–°UIï¼‰
        _goldText.BindNumber(_goldObserver, "é‡‘å¸: {0}");
    }
}
```

### 5.2 ç»‘å®šæ‰©å±•æ–¹æ³•

| æ–¹æ³• | ç”¨é€” | ç¤ºä¾‹ |
|------|------|------|
| `BindText()` | ç»‘å®šæ–‡æœ¬ | `_nameText.BindText(nameObserver)` |
| `BindNumber()` | ç»‘å®šæ•°å­— | `_scoreText.BindNumber(scoreObserver, "åˆ†æ•°: {0}")` |
| `BindActive()` | ç»‘å®šæ¿€æ´»çŠ¶æ€ | `_panel.BindActive(visibleObserver)` |
| `BindFillAmount()` | ç»‘å®šè¿›åº¦æ¡ | `_progressBar.BindFillAmount(progressObserver)` |
| `BindToggle()` | ç»‘å®šToggleï¼ˆåŒå‘ï¼‰ | `_soundToggle.BindToggle(soundEnabledObserver)` |

---

## 6. é«˜çº§åŠŸèƒ½

### 6.1 UIæ ˆç®¡ç†

```csharp
// æ¨å…¥UIæ ˆï¼ˆæ”¯æŒè¿”å›åŠŸèƒ½ï¼‰
GridFramework.UI.PushUI<SettingsUI>();

// è¿”å›ä¸Šä¸€ä¸ªUI
await GridFramework.UI.PopUI();

// è·å–UIæ ˆ
var stack = GridFramework.UI.GetUIStack();
```

### 6.2 UIé¢„åŠ è½½

```csharp
// åœ¨å¯åŠ¨æ—¶é¢„åŠ è½½
async void Start()
{
    await GridFramework.UI.PreloadUI<MainMenuUI>();
    await GridFramework.UI.PreloadUI<LoadingUI>();
    
    // ç°åœ¨æ˜¾ç¤ºä¼šéå¸¸å¿«
    GridFramework.UI.Show<MainMenuUI>();
}
```

æˆ–è€…åœ¨UIManifestä¸­é…ç½® `Preload = true`ï¼Œå¯åŠ¨æ—¶è‡ªåŠ¨é¢„åŠ è½½ã€‚

### 6.3 å…¶ä»–API

```csharp
// é”€æ¯UI
await GridFramework.UI.DestroyUI<MainMenuUI>();

// æ£€æŸ¥UIæ˜¯å¦æ˜¾ç¤º
bool isShowing = GridFramework.UI.IsShowing<MainMenuUI>();

// è·å–UIå®ä¾‹
var ui = GridFramework.UI.GetUI<MainMenuUI>();

// éšè—æ‰€æœ‰UIï¼ˆå¯æ’é™¤æŸäº›ï¼‰
await GridFramework.UI.HideAll(typeof(LoadingUI));

// ç½®é¡¶UI
GridFramework.UI.BringToFront<ImportantPopupUI>();
```

---

## 7. å¸¸è§é—®é¢˜

### Q1: æ‰¾ä¸åˆ°ç»„ä»¶é”™è¯¯ï¼Ÿ

**é—®é¢˜**ï¼šè¿è¡Œæ—¶æŠ¥é”™ `æ‰¾ä¸åˆ°ç»„ä»¶: @Button_Start`

**åŸå› **ï¼š
- Prefabä¸­åˆ é™¤äº†æ ‡è®°çš„ç»„ä»¶
- èŠ‚ç‚¹åç§°æ”¹å˜äº†
- è·¯å¾„æ”¹å˜äº†

**è§£å†³**ï¼š
1. é‡æ–°æ‰“å¼€Prefabï¼Œæ£€æŸ¥ç»„ä»¶æ˜¯å¦å­˜åœ¨
2. é‡æ–°ç”Ÿæˆä»£ç ï¼ˆä¼šæ›´æ–°è·¯å¾„ï¼‰

---

### Q2: Logic.csè¢«è¦†ç›–äº†ï¼Ÿ

**é—®é¢˜**ï¼šæ‰‹å†™çš„ä»£ç ä¸¢å¤±äº†

**åŸå› **ï¼šä¸åº”è¯¥åœ¨Binding.csä¸­å†™ä»£ç 

**è§£å†³**ï¼š
- æ‰€æœ‰ä¸šåŠ¡é€»è¾‘å†™åœ¨ `XXX.cs`ï¼ˆLogicæ–‡ä»¶ï¼‰
- æ°¸è¿œä¸è¦ä¿®æ”¹ `XXX.Binding.cs`ï¼ˆBindingæ–‡ä»¶ï¼‰

---

### Q3: UIæ˜¾ç¤ºä¸å‡ºæ¥ï¼Ÿ

**æ£€æŸ¥æ¸…å•**ï¼š
1. âœ… æ˜¯å¦è°ƒç”¨äº† `GridFramework.UI.Show<XXX>()`
2. âœ… ResourcePathæ˜¯å¦æ­£ç¡®ï¼ˆç›¸å¯¹äºResourcesï¼‰
3. âœ… Prefabæ˜¯å¦åœ¨Resourcesç›®å½•ä¸‹
4. âœ… æ£€æŸ¥Consoleæ˜¯å¦æœ‰é”™è¯¯æ—¥å¿—

---

### Q4: å¦‚ä½•æ·»åŠ è‡ªå®šä¹‰Attachmentï¼Ÿ

```csharp
public partial class MainMenuUI
{
    protected override void OnAttachmentInitialize(List<UIAttachment> attachments)
    {
        base.OnAttachmentInitialize(attachments);
        
        // æ·»åŠ è‡ªå®šä¹‰Attachment
        attachments.Add(new MyCustomAttachment());
    }
}
```

---

### Q5: å¦‚ä½•æ”¯æŒå¤šè¯­è¨€ï¼Ÿ

æš‚æ—¶é€šè¿‡æ‰‹åŠ¨å®ç°ï¼š

```csharp
protected override void OnShow(params object[] args)
{
    base.OnShow(args);
    
    // ä½¿ç”¨å¤šè¯­è¨€ç³»ç»Ÿï¼ˆå¦‚æœæœ‰ï¼‰
    _titleText.text = I18n.Get("ui.main.title");
}
```

åç»­ç‰ˆæœ¬ä¼šé›†æˆå¤šè¯­è¨€æ”¯æŒã€‚

---

## ğŸ“Œ æœ€ä½³å®è·µ

### âœ… æ¨èåšæ³•

1. **ç»Ÿä¸€æ”¾ç½®èµ„æº**
   - UI Prefabï¼š`Assets/Resources/UI/`
   - UIè„šæœ¬ï¼š`Assets/Game/Scripts/UI/`

2. **å‘½åè§„èŒƒ**
   - Prefabï¼š`MainMenu.prefab`
   - ç±»åï¼š`MainMenuUI`ï¼ˆè‡ªåŠ¨æ·»åŠ UIåç¼€ï¼‰

3. **é…ç½®ä¼˜å…ˆçº§**
   - å¼€å‘é˜¶æ®µï¼šä»£ç é…ç½®
   - è°ƒä¼˜é˜¶æ®µï¼šUIManifesté…ç½®

4. **ä½¿ç”¨æ•°æ®ç»‘å®š**
   - Textã€Imageç­‰å±•ç¤ºç»„ä»¶ä½¿ç”¨Observerç»‘å®š
   - æ•°æ®å˜åŒ–è‡ªåŠ¨æ›´æ–°UI

### âŒ é¿å…çš„åšæ³•

1. **ä¸è¦æ‰‹åŠ¨ä¿®æ”¹Binding.cs**
2. **ä¸è¦åœ¨æ„é€ å‡½æ•°ä¸­è®¿é—®ç»„ä»¶**ï¼ˆç»„ä»¶åœ¨OnCreateåæ‰ç»‘å®šï¼‰
3. **ä¸è¦å¿˜è®°è°ƒç”¨baseæ–¹æ³•**ï¼ˆOnShowã€OnHideç­‰ï¼‰
4. **ä¸è¦åœ¨OnDestroyåè®¿é—®ç»„ä»¶**ï¼ˆå·²è¢«é”€æ¯ï¼‰

---

## ğŸ¯ å·¥ä½œæµç¨‹

```
è®¾è®¡Prefabï¼ˆæ ‡è®°ç»„ä»¶ï¼‰
    â†“
ç”Ÿæˆä»£ç ï¼ˆå·¥å…·è‡ªåŠ¨ï¼‰
    â†“
ç¼–å†™é€»è¾‘ï¼ˆOnShowã€äº‹ä»¶å¤„ç†ï¼‰
    â†“
é…ç½®å±æ€§ï¼ˆUIManifestå¯é€‰ï¼‰
    â†“
è¿è¡Œæµ‹è¯•ï¼ˆGridFramework.UI.Showï¼‰
    â†“
è°ƒä¼˜ï¼ˆä¿®æ”¹é…ç½®ã€é‡æ–°ç”Ÿæˆï¼‰
```

---

## ğŸ“š å»¶ä¼¸é˜…è¯»

- [UIå‘½åè§„èŒƒ](./UIå‘½åè§„èŒƒ.md)
- [UIæœ€ä½³å®è·µ](./UIæœ€ä½³å®è·µ.md)
- [å¼€å‘æ‰©å±•ç¼–ç è§„èŒƒ](./å¼€å‘æ‰©å±•ç¼–ç è§„èŒƒ.md)
- [UIç³»ç»Ÿé‡æ„æŠ€æœ¯è§„æ ¼ä¹¦](./UIç³»ç»Ÿé‡æ„æŠ€æœ¯è§„æ ¼ä¹¦.md)

---

**æ–‡æ¡£ç‰ˆæœ¬**: v2.0  
**ç»´æŠ¤è€…**: GGFramework Team  
**åé¦ˆ**: å¦‚æœ‰é—®é¢˜è¯·è”ç³»æ¡†æ¶ç»´æŠ¤è€…

